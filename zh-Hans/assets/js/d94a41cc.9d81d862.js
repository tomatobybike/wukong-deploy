"use strict";(self.webpackChunkwukong_deploy_website=self.webpackChunkwukong_deploy_website||[]).push([[4580],{6358:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"configuration/config-file","title":"Configuration File","description":"File Structure","source":"@site/docs/configuration/config-file.md","sourceDirName":"configuration","slug":"/configuration/config-file","permalink":"/wukong-deploy/zh-Hans/docs/configuration/config-file","draft":false,"unlisted":false,"editUrl":"https://github.com/tomatobybike/wukong-deploy/tree/main/wukong-deploy-website/docs/configuration/config-file.md","tags":[],"version":"current","lastUpdatedBy":"tom","lastUpdatedAt":1759752389000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Introduction","permalink":"/wukong-deploy/zh-Hans/docs/getting-started/introduction"},"next":{"title":"\u73af\u5883\u53d8\u91cf\u914d\u7f6e","permalink":"/wukong-deploy/zh-Hans/docs/configuration/env-variables"}}');var i=r(4848),d=r(8453);const s={sidebar_position:1},o="Configuration File",c={},l=[{value:"File Structure",id:"file-structure",level:2},{value:"Server Configuration",id:"server-configuration",level:2},{value:"Command Configuration",id:"command-configuration",level:2},{value:"Complete Example",id:"complete-example",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"configuration-file",children:"Configuration File"})}),"\n",(0,i.jsx)(n.h2,{id:"file-structure",children:"File Structure"}),"\n",(0,i.jsxs)(n.p,{children:["wukong-deploy uses ",(0,i.jsx)(n.code,{children:"config/config.mjs"})," as its main configuration file. This is an ES Module file that should export a configuration object."]}),"\n",(0,i.jsx)(n.p,{children:"Basic structure:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'export default {\n  showCommandLog: true,  // Show command execution logs\n  servers: {\n    dev: {  // Server configuration key\n      name: "Development Server",  // Server description\n      host: "192.168.1.100",  // Server address\n      username: "root",  // SSH username\n      passwordEnv: "SERVER_PASSWORD",  // Password environment variable\n      commands: [  // List of commands to execute\n        {\n          cmd: "git pull",  // Command to execute\n          cwd: "/path/to/project",  // Working directory\n          description: "Update code",  // Command description\n          exitOnStdErr: false,  // Exit on error\n          errorMatch: /Permission denied/  // Error matching pattern\n        }\n      ],\n      finishMsg: "\ud83c\udf89 Deployment complete"  // Completion message\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"server-configuration",children:"Server Configuration"}),"\n",(0,i.jsx)(n.p,{children:"Each server configuration contains the following fields:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Field Name"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Required"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"name"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Server description"}),(0,i.jsx)(n.td,{children:"Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"host"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Server address"}),(0,i.jsx)(n.td,{children:"Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"username"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"SSH username"}),(0,i.jsx)(n.td,{children:"Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"passwordEnv"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Password environment variable"}),(0,i.jsx)(n.td,{children:"Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"commands"}),(0,i.jsx)(n.td,{children:"array"}),(0,i.jsx)(n.td,{children:"Command list"}),(0,i.jsx)(n.td,{children:"Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"finishMsg"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Completion message"}),(0,i.jsx)(n.td,{children:"No"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"command-configuration",children:"Command Configuration"}),"\n",(0,i.jsx)(n.p,{children:"Each command object supports the following configuration:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Field Name"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Default"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"cmd"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Command to execute"}),(0,i.jsx)(n.td,{children:"-"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"cwd"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Working directory"}),(0,i.jsx)(n.td,{children:"-"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"description"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Command description"}),(0,i.jsx)(n.td,{children:"-"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"exitOnStdErr"}),(0,i.jsx)(n.td,{children:"boolean"}),(0,i.jsx)(n.td,{children:"Exit on error"}),(0,i.jsx)(n.td,{children:"true"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"errorMatch"}),(0,i.jsx)(n.td,{children:"RegExp"}),(0,i.jsx)(n.td,{children:"Error matching pattern"}),(0,i.jsx)(n.td,{children:"-"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"isLocal"}),(0,i.jsx)(n.td,{children:"boolean"}),(0,i.jsx)(n.td,{children:"Execute locally"}),(0,i.jsx)(n.td,{children:"false"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'export default {\n  showCommandLog: true,\n  servers: {\n    dev: {\n      name: "Development Server",\n      host: "192.168.1.100",\n      username: "root",\n      passwordEnv: "SERVER_DEV_PASSWORD",\n      commands: [\n        {\n          cmd: "git pull",\n          cwd: "/var/www/app",\n          description: "Update code",\n          exitOnStdErr: false\n        },\n        {\n          cmd: "npm install",\n          cwd: "/var/www/app",\n          description: "Install dependencies"\n        },\n        {\n          cmd: "npm run build",\n          cwd: "/var/www/app",\n          description: "Build project"\n        },\n        {\n          cmd: "pm2 restart app",\n          cwd: "/var/www/app",\n          description: "Restart service"\n        }\n      ],\n      finishMsg: "\ud83c\udf89 Development environment deployment complete!"\n    },\n    prod: {\n      name: "Production Server",\n      host: "10.0.0.1",\n      username: "deploy",\n      passwordEnv: "SERVER_PROD_PASSWORD",\n      commands: [\n        {\n          cmd: "git pull origin main",\n          cwd: "/var/www/production",\n          description: "Update main branch code"\n        },\n        {\n          cmd: "npm ci",\n          cwd: "/var/www/production",\n          description: "Install dependencies (production)"\n        }\n      ],\n      finishMsg: "\ud83d\ude80 Production environment deployment complete!"\n    }\n  }\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>o});var t=r(6540);const i={},d=t.createContext(i);function s(e){const n=t.useContext(d);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(d.Provider,{value:n},e.children)}}}]);