"use strict";(self.webpackChunkwukong_deploy_website=self.webpackChunkwukong_deploy_website||[]).push([[7444],{3627:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"best-practices/project-structure","title":"\u9879\u76ee\u7ed3\u6784","description":"\u672c\u6587\u4ecb\u7ecd\u4f7f\u7528 wukong-deploy \u65f6\u63a8\u8350\u7684\u9879\u76ee\u7ed3\u6784\u548c\u6587\u4ef6\u7ec4\u7ec7\u65b9\u5f0f\u3002","source":"@site/docs/best-practices/project-structure.md","sourceDirName":"best-practices","slug":"/best-practices/project-structure","permalink":"/wukong-deploy/docs/best-practices/project-structure","draft":false,"unlisted":false,"editUrl":"https://github.com/tomatobybike/wukong-deploy/tree/main/wukong-deploy-website/docs/best-practices/project-structure.md","tags":[],"version":"current","lastUpdatedBy":"tom","lastUpdatedAt":1759746647000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"\u9519\u8bef\u5904\u7406","permalink":"/wukong-deploy/docs/advanced/error-handling"},"next":{"title":"\u4f7f\u7528\u793a\u4f8b","permalink":"/wukong-deploy/docs/examples/use-cases"}}');var d=s(4848),i=s(8453);const o={sidebar_position:1},l="\u9879\u76ee\u7ed3\u6784",c={},t=[{value:"\u57fa\u672c\u7ed3\u6784",id:"\u57fa\u672c\u7ed3\u6784",level:2},{value:"\u914d\u7f6e\u6587\u4ef6\u7ec4\u7ec7",id:"\u914d\u7f6e\u6587\u4ef6\u7ec4\u7ec7",level:2},{value:"\u73af\u5883\u53d8\u91cf\u7ba1\u7406",id:"\u73af\u5883\u53d8\u91cf\u7ba1\u7406",level:2},{value:"\u670d\u52a1\u5668\u914d\u7f6e\u793a\u4f8b",id:"\u670d\u52a1\u5668\u914d\u7f6e\u793a\u4f8b",level:2},{value:"\u547d\u4ee4\u7ec4\u7ec7",id:"\u547d\u4ee4\u7ec4\u7ec7",level:2},{value:"\u6700\u4f73\u5b9e\u8df5\u5efa\u8bae",id:"\u6700\u4f73\u5b9e\u8df5\u5efa\u8bae",level:2}];function a(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.header,{children:(0,d.jsx)(e.h1,{id:"\u9879\u76ee\u7ed3\u6784",children:"\u9879\u76ee\u7ed3\u6784"})}),"\n",(0,d.jsx)(e.p,{children:"\u672c\u6587\u4ecb\u7ecd\u4f7f\u7528 wukong-deploy \u65f6\u63a8\u8350\u7684\u9879\u76ee\u7ed3\u6784\u548c\u6587\u4ef6\u7ec4\u7ec7\u65b9\u5f0f\u3002"}),"\n",(0,d.jsx)(e.h2,{id:"\u57fa\u672c\u7ed3\u6784",children:"\u57fa\u672c\u7ed3\u6784"}),"\n",(0,d.jsx)(e.p,{children:"\u63a8\u8350\u7684\u9879\u76ee\u7ed3\u6784\u5982\u4e0b\uff1a"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:"your-project/\n\u251c\u2500\u2500 config/\n\u2502   \u2514\u2500\u2500 config.mjs     # wukong-deploy \u914d\u7f6e\u6587\u4ef6\n\u251c\u2500\u2500 scripts/           # \u90e8\u7f72\u76f8\u5173\u7684\u811a\u672c\n\u2502   \u251c\u2500\u2500 build.sh\n\u2502   \u2514\u2500\u2500 deploy.sh\n\u251c\u2500\u2500 .env              # \u73af\u5883\u53d8\u91cf\u6587\u4ef6\n\u2514\u2500\u2500 package.json\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u914d\u7f6e\u6587\u4ef6\u7ec4\u7ec7",children:"\u914d\u7f6e\u6587\u4ef6\u7ec4\u7ec7"}),"\n",(0,d.jsx)(e.p,{children:"\u5bf9\u4e8e\u5927\u578b\u9879\u76ee\uff0c\u53ef\u4ee5\u5c06\u914d\u7f6e\u6587\u4ef6\u62c6\u5206\u4e3a\u591a\u4e2a\u6a21\u5757\uff1a"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:"config/\n\u251c\u2500\u2500 config.mjs           # \u4e3b\u914d\u7f6e\u6587\u4ef6\n\u251c\u2500\u2500 servers/            # \u670d\u52a1\u5668\u914d\u7f6e\n\u2502   \u251c\u2500\u2500 dev.mjs\n\u2502   \u251c\u2500\u2500 staging.mjs\n\u2502   \u2514\u2500\u2500 prod.mjs\n\u2514\u2500\u2500 commands/           # \u547d\u4ee4\u914d\u7f6e\n    \u251c\u2500\u2500 build.mjs\n    \u251c\u2500\u2500 deploy.mjs\n    \u2514\u2500\u2500 maintenance.mjs\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u73af\u5883\u53d8\u91cf\u7ba1\u7406",children:"\u73af\u5883\u53d8\u91cf\u7ba1\u7406"}),"\n",(0,d.jsx)(e.p,{children:"\u63a8\u8350\u7684\u73af\u5883\u53d8\u91cf\u6587\u4ef6\u7ed3\u6784\uff1a"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:".env                # \u9ed8\u8ba4\u73af\u5883\u53d8\u91cf\uff08\u8981\u52a0\u5165 .gitignore\uff09\n.env.example        # \u73af\u5883\u53d8\u91cf\u793a\u4f8b\uff08\u53ef\u4ee5\u63d0\u4ea4\u5230 Git\uff09\n.env.development    # \u5f00\u53d1\u73af\u5883\u53d8\u91cf\n.env.production     # \u751f\u4ea7\u73af\u5883\u53d8\u91cf\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u670d\u52a1\u5668\u914d\u7f6e\u793a\u4f8b",children:"\u670d\u52a1\u5668\u914d\u7f6e\u793a\u4f8b"}),"\n",(0,d.jsx)(e.p,{children:"\u5206\u73af\u5883\u7684\u670d\u52a1\u5668\u914d\u7f6e\u793a\u4f8b\uff1a"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-javascript",children:'// config/servers/dev.mjs\nexport default {\n  name: "\u5f00\u53d1\u670d\u52a1\u5668",\n  host: "dev.example.com",\n  username: "deploy",\n  passwordEnv: "SERVER_DEV_PASSWORD",\n  commands: [/* ... */]\n}\n\n// config/servers/prod.mjs\nexport default {\n  name: "\u751f\u4ea7\u670d\u52a1\u5668",\n  host: "example.com",\n  username: "deploy",\n  passwordEnv: "SERVER_PROD_PASSWORD",\n  commands: [/* ... */]\n}\n\n// config/config.mjs\nimport devServer from \'./servers/dev.mjs\'\nimport prodServer from \'./servers/prod.mjs\'\n\nexport default {\n  servers: {\n    dev: devServer,\n    prod: prodServer\n  }\n}\n'})}),"\n",(0,d.jsx)(e.h2,{id:"\u547d\u4ee4\u7ec4\u7ec7",children:"\u547d\u4ee4\u7ec4\u7ec7"}),"\n",(0,d.jsx)(e.p,{children:"\u6309\u529f\u80fd\u6a21\u5757\u7ec4\u7ec7\u547d\u4ee4\uff1a"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-javascript",children:'// config/commands/build.mjs\nexport const buildCommands = [\n  {\n    cmd: "npm run build",\n    description: "\u6784\u5efa\u9879\u76ee"\n  }\n]\n\n// config/commands/deploy.mjs\nexport const deployCommands = [\n  {\n    cmd: "pm2 reload all",\n    description: "\u91cd\u542f\u670d\u52a1"\n  }\n]\n\n// config/config.mjs\nimport { buildCommands } from \'./commands/build.mjs\'\nimport { deployCommands } from \'./commands/deploy.mjs\'\n\nexport default {\n  servers: {\n    dev: {\n      // ...\n      commands: [\n        ...buildCommands,\n        ...deployCommands\n      ]\n    }\n  }\n}\n'})}),"\n",(0,d.jsx)(e.h2,{id:"\u6700\u4f73\u5b9e\u8df5\u5efa\u8bae",children:"\u6700\u4f73\u5b9e\u8df5\u5efa\u8bae"}),"\n",(0,d.jsxs)(e.ol,{children:["\n",(0,d.jsxs)(e.li,{children:["\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"\u914d\u7f6e\u6587\u4ef6\u5206\u79bb"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"\u5c06\u4e0d\u540c\u73af\u5883\u7684\u914d\u7f6e\u5206\u5f00\u7ba1\u7406"}),"\n",(0,d.jsx)(e.li,{children:"\u4f7f\u7528\u6a21\u5757\u5316\u7684\u65b9\u5f0f\u7ec4\u7ec7\u914d\u7f6e"}),"\n",(0,d.jsx)(e.li,{children:"\u654f\u611f\u4fe1\u606f\u4f7f\u7528\u73af\u5883\u53d8\u91cf"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"\u9519\u8bef\u5904\u7406"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"\u4e3a\u91cd\u8981\u547d\u4ee4\u914d\u7f6e errorMatch"}),"\n",(0,d.jsx)(e.li,{children:"\u5408\u7406\u8bbe\u7f6e exitOnStdErr"}),"\n",(0,d.jsx)(e.li,{children:"\u6dfb\u52a0\u9519\u8bef\u91cd\u8bd5\u673a\u5236"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"\u5b89\u5168\u6027"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"\u4e0d\u8981\u5728\u4ee3\u7801\u4e2d\u786c\u7f16\u7801\u5bc6\u7801"}),"\n",(0,d.jsx)(e.li,{children:"\u4f7f\u7528 .gitignore \u6392\u9664\u654f\u611f\u6587\u4ef6"}),"\n",(0,d.jsx)(e.li,{children:"\u9650\u5236\u670d\u52a1\u5668\u7528\u6237\u6743\u9650"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"\u53ef\u7ef4\u62a4\u6027"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"\u4e3a\u547d\u4ee4\u6dfb\u52a0\u6e05\u6670\u7684\u63cf\u8ff0"}),"\n",(0,d.jsx)(e.li,{children:"\u4f7f\u7528\u6709\u610f\u4e49\u7684\u914d\u7f6e\u952e\u540d"}),"\n",(0,d.jsx)(e.li,{children:"\u4fdd\u6301\u914d\u7f6e\u6587\u4ef6\u7684\u6574\u6d01\u548c\u4e00\u81f4\u6027"}),"\n"]}),"\n"]}),"\n"]})]})}function p(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,d.jsx)(e,{...n,children:(0,d.jsx)(a,{...n})}):a(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>o,x:()=>l});var r=s(6540);const d={},i=r.createContext(d);function o(n){const e=r.useContext(i);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:o(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);