import{createHash as p}from"node:crypto";import o from"node:os";function c(){let e=process.env.LANG||process.env.LC_ALL||process.env.LANGUAGE||"";return/^zh/i.test(e)?"zh":"en"}function i(e=process.argv){let t=e.find(n=>n.startsWith("--lang="));return t?t.split("=")[1].toLowerCase():null}function r(e=process.argv){return i(e)||c()}var g="https://api.hisread.com/api/track/wukong";function m(){let e=`${o.hostname()}|${o.arch()}`;return p("sha256").update(e).digest("hex").slice(0,12)}async function f(e,t={version:"unknown"},n={}){if(process.env.WUKONG_NO_TELEMETRY==="1")return;let s=r(n.argv||process.argv),a={event:e,time:new Date().getTime(),platform:process.platform,arch:process.arch,node:process.version,lang:s,cli:n.cliName||"unknown-cli",id:m(),...t};try{await fetch(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})}catch{}}export{r as getLang,f as sendTelemetry};
